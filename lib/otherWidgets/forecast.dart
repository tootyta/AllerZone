import 'dart:convert';
import 'package:apps/otherWidgets/hourCard.dart';
import 'package:apps/services/location.dart';
import 'package:flutter/material.dart';
import 'package:http/http.dart';

import 'home.dart';

class forecast extends StatefulWidget {
  late Location attr;
  forecast({Key? key, required this.attr}) : super(key: key);

  @override
  _forecastState createState() => _forecastState();
}

class _forecastState extends State<forecast> {
  Map data = {};
  List<Widget> widgetList = [];
  Widget loadingWidget = Container();

  @protected
  @mustCallSuper
  @override
  void initState() {
    super.initState();
    _grabForecast(); //grab it right away over button so we can load the card tiles right away!
  }

  @override
  Widget build(BuildContext context) {
    return loadingWidget;
  }

  Future<void> _grabForecast() async {
    if(data.isEmpty) {
      WidgetsBinding.instance!.addPostFrameCallback((_) {
        Navigator.pushNamed(context, '/loading', arguments: {
          'loadingTime': 3.00
        });
      });
      double lat = await widget.attr.getLatitude(); //
      double long = await widget.attr.getLongitude(); //
      //await Future.delayed(Duration(seconds: 5)); //only necessary with fake data b/c otherwise it runs before the widget is disposed etc
      Response response = await get(Uri.parse("https://api.ambeedata.com/forecast/pollen/by-lat-lng?lat=" + lat.toString() + "&lng=" + long.toString()), headers: headers);
      data = jsonDecode(response.body);

      /*
      data = jsonDecode(
          '{"message":"success","lat":30.618755,"lng":-96.33647666666667,"data":[{"Count":{"grass_pollen":15,"tree_pollen":0,"weed_pollen":42},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":15},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":42}},"time":1627441200},{"Count":{"grass_pollen":14,"tree_pollen":0,"weed_pollen":36},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":14},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":36}},"time":1627444800},{"Count":{"grass_pollen":15,"tree_pollen":0,"weed_pollen":38},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":15},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":38}},"time":1627448400},{"Count":{"grass_pollen":13,"tree_pollen":0,"weed_pollen":34},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":13},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":34}},"time":1627452000},{"Count":{"grass_pollen":16,"tree_pollen":0,"weed_pollen":41},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":16},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":41}},"time":1627455600},{"Count":{"grass_pollen":19,"tree_pollen":0,"weed_pollen":50},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":19},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":50}},"time":1627459200},{"Count":{"grass_pollen":16,"tree_pollen":0,"weed_pollen":45},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":16},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":45}},"time":1627462800},{"Count":{"grass_pollen":10,"tree_pollen":0,"weed_pollen":29},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":10},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":29}},"time":1627466400},{"Count":{"grass_pollen":8,"tree_pollen":0,"weed_pollen":23},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":8},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":23}},"time":1627470000},{"Count":{"grass_pollen":13,"tree_pollen":0,"weed_pollen":32},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":13},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":32}},"time":1627473600},{"Count":{"grass_pollen":11,"tree_pollen":0,"weed_pollen":28},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":11},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":28}},"time":1627477200},{"Count":{"grass_pollen":5,"tree_pollen":0,"weed_pollen":13},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Low"},"Species":{"Grass":{"Grass / Poaceae":5},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":13}},"time":1627480800},{"Count":{"grass_pollen":10,"tree_pollen":0,"weed_pollen":27},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":10},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":27}},"time":1627484400},{"Count":{"grass_pollen":10,"tree_pollen":0,"weed_pollen":29},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":10},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":29}},"time":1627488000},{"Count":{"grass_pollen":11,"tree_pollen":0,"weed_pollen":32},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":11},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":32}},"time":1627491600},{"Count":{"grass_pollen":10,"tree_pollen":0,"weed_pollen":27},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":10},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":27}},"time":1627495200},{"Count":{"grass_pollen":14,"tree_pollen":0,"weed_pollen":36},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":14},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":36}},"time":1627498800},{"Count":{"grass_pollen":12,"tree_pollen":0,"weed_pollen":31},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":12},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":31}},"time":1627502400},{"Count":{"grass_pollen":19,"tree_pollen":0,"weed_pollen":47},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":19},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":47}},"time":1627506000},{"Count":{"grass_pollen":18,"tree_pollen":0,"weed_pollen":47},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":18},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":47}},"time":1627509600},{"Count":{"grass_pollen":15,"tree_pollen":0,"weed_pollen":42},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":15},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":42}},"time":1627513200},{"Count":{"grass_pollen":19,"tree_pollen":0,"weed_pollen":50},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":19},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":50}},"time":1627516800},{"Count":{"grass_pollen":14,"tree_pollen":0,"weed_pollen":40},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":14},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":40}},"time":1627520400},{"Count":{"grass_pollen":15,"tree_pollen":0,"weed_pollen":41},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":15},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":41}},"time":1627524000},{"Count":{"grass_pollen":11,"tree_pollen":0,"weed_pollen":30},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":11},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":30}},"time":1627527600},{"Count":{"grass_pollen":15,"tree_pollen":0,"weed_pollen":36},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":15},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":36}},"time":1627531200},{"Count":{"grass_pollen":12,"tree_pollen":0,"weed_pollen":31},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":12},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":31}},"time":1627534800},{"Count":{"grass_pollen":15,"tree_pollen":0,"weed_pollen":38},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":15},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":38}},"time":1627538400},{"Count":{"grass_pollen":14,"tree_pollen":0,"weed_pollen":37},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":14},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":37}},"time":1627542000},{"Count":{"grass_pollen":15,"tree_pollen":0,"weed_pollen":42},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":15},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":42}},"time":1627545600},{"Count":{"grass_pollen":10,"tree_pollen":0,"weed_pollen":29},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":10},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":29}},"time":1627549200},{"Count":{"grass_pollen":9,"tree_pollen":0,"weed_pollen":24},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":9},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":24}},"time":1627552800},{"Count":{"grass_pollen":13,"tree_pollen":0,"weed_pollen":32},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":13},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":32}},"time":1627556400},{"Count":{"grass_pollen":10,"tree_pollen":0,"weed_pollen":27},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":10},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":27}},"time":1627560000},{"Count":{"grass_pollen":11,"tree_pollen":0,"weed_pollen":28},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":11},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":28}},"time":1627563600},{"Count":{"grass_pollen":5,"tree_pollen":0,"weed_pollen":14},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Low"},"Species":{"Grass":{"Grass / Poaceae":5},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":14}},"time":1627567200},{"Count":{"grass_pollen":9,"tree_pollen":0,"weed_pollen":26},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":9},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":26}},"time":1627570800},{"Count":{"grass_pollen":11,"tree_pollen":0,"weed_pollen":30},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":11},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":30}},"time":1627574400},{"Count":{"grass_pollen":11,"tree_pollen":0,"weed_pollen":30},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":11},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":30}},"time":1627578000},{"Count":{"grass_pollen":22,"tree_pollen":0,"weed_pollen":55},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":22},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":55}},"time":1627581600},{"Count":{"grass_pollen":19,"tree_pollen":0,"weed_pollen":48},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":19},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":48}},"time":1627585200},{"Count":{"grass_pollen":20,"tree_pollen":0,"weed_pollen":49},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":20},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":49}},"time":1627588800},{"Count":{"grass_pollen":19,"tree_pollen":0,"weed_pollen":49},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":19},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":49}},"time":1627592400},{"Count":{"grass_pollen":16,"tree_pollen":0,"weed_pollen":44},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":16},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":44}},"time":1627596000},{"Count":{"grass_pollen":18,"tree_pollen":0,"weed_pollen":49},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":18},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":49}},"time":1627599600},{"Count":{"grass_pollen":12,"tree_pollen":0,"weed_pollen":35},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":12},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":35}},"time":1627603200},{"Count":{"grass_pollen":14,"tree_pollen":0,"weed_pollen":38},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":14},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":38}},"time":1627606800},{"Count":{"grass_pollen":19,"tree_pollen":0,"weed_pollen":52},"Risk":{"grass_pollen":"Low","tree_pollen":"Low","weed_pollen":"Moderate"},"Species":{"Grass":{"Grass / Poaceae":19},"Others":0,"Tree":{"Ash":0,"Birch":0,"Cypress / Juniper / Cedar":0,"Elm":0,"Maple":0,"Mulberry":0,"Oak":0,"Pine":0,"Poplar / Cottonwood":0},"Weed":{"Ragweed":52}},"time":1627610400}]}');
      //YAS FAKE DATA!
*/
      }

      Navigator.pop(context);
      widgetList.add(Container(height:20)); //spacing
      widgetList.add(Text(
          "Hourly Forecast for 48 Hours",
          style: TextStyle(
            fontWeight: FontWeight.bold,
            fontStyle: FontStyle.italic,
          ),
      )); //adds title
      widgetList.add(Container(height:20)); //spacing
      for(int i = 0; i < data['data'].length; i++) { //will always re-create widget list aaltho may be inefficient??
        widgetList.add(Row(
          children: [
            Container(width: 10),
            Expanded(child: hourCard(attributes: data['data'][i])),
            Container(width: 10),
          ],
        ));
      }
      setState(() { //gets rid of loading widgets
        loadingWidget = Container(
          child: Scrollbar(
            child: SingleChildScrollView(
              child: Column(
                children: widgetList,
              ),
            ),
          ),
        );
      });
  }

}
